if(window.Node&&Node.prototype&&!Node.prototype.contains)Node.prototype.contains=function(a){return!!(this.compareDocumentPosition(a)&16)}; (function(a){a.extend(a.expr[":"],{sortable:"(' '+a.className+' ').indexOf(' ui-sortable ')"});a.fn.sortable=function(b){return this.each(function(){new a.ui.sortable(this,b)})};for(var o="destroy,enable,disable,refresh".split(","),m=0;m<o.length;m++){var n=o[m];eval('f = function() { var a = arguments; return this.each(function() { if(jQuery(this).is(".ui-sortable")) jQuery.data(this, "ui-sortable")["'+n+'"](a); }); }');a.fn["sortable"+n.substr(0,1).toUpperCase()+n.substr(1)]=void 0}a.fn.sortableInstance= function(){if(a(this[0]).is(".ui-sortable"))return a.data(this[0],"ui-sortable");return false};a.ui.sortable=function(b,h){this.element=b;this.set=[];var c={},d=this;a.data(this.element,"ui-sortable",this);a(b).addClass("ui-sortable");a.extend(c,h);a.extend(c,{items:c.items||">  li",smooth:c.smooth!=undefined?c.smooth:true,helper:"clone",containment:c.containment?c.containment=="sortable"?b:c.containment:null,zIndex:c.zIndex||1E3,_start:function(j,k,i,f,g){d.start.apply(f,[d,g])},_beforeStop:function(j, k,i,f,g){d.stop.apply(f,[d,g])},_drag:function(j,k,i,f,g){d.drag.apply(f,[d,g])},startCondition:function(){return!d.disabled}});var e=a(c.items,b);c.floating=/left|right/.test(e.css("float"));a(b).css("position")=="static"&&a(b).css("position","relative");c.offset=a(b).offset({border:false});e.each(function(){new a.ui.mouseInteraction(this,c)});e.each(function(){d.set.push([this,null])});this.options=c};a.extend(a.ui.sortable.prototype,{plugins:{},currentTarget:null,lastTarget:null,prepareCallbackObj:function(b, h){if(!b.pos)b.pos=[0,0];return{helper:b.helper,position:{left:b.pos[0],top:b.pos[1]},offset:b.options.cursorAt,draggable:b,current:h,options:b.options}},refresh:function(){var b=this,h=a(this.options.items,this.element),c=[];h.each(function(){old=false;for(var e=0;e<b.set.length;e++)if(b.set[e][0]==this)old=true;old||c.push(this)});for(var d=0;d<c.length;d++)new a.ui.mouseInteraction(c[d],b.options);this.set=[];h.each(function(){b.set.push([this,null])})},destroy:function(){a(this.element).removeClass("ui-sortable").removeClass("ui-sortable-disabled"); a(this.options.items,this.element).mouseInteractionDestroy()},enable:function(){a(this.element).removeClass("ui-sortable-disabled");this.disabled=false},disable:function(){a(this.element).addClass("ui-sortable-disabled");this.disabled=true},start:function(b,h){var c=this.options;if(c.hoverClass)b.helper=a('<div class="'+c.hoverClass+'"></div>').appendTo("body").css({height:this.element.offsetHeight+"px",width:this.element.offsetWidth+"px",position:"absolute"});if(c.zIndex){if(a(this.helper).css("zIndex"))c.ozIndex= a(this.helper).css("zIndex");a(this.helper).css("zIndex",c.zIndex)}b.firstSibling=a(this.element).prev()[0];a(this.element).css("visibility","hidden");a(this.element).triggerHandler("sortstart",[h,b.prepareCallbackObj(this)],c.start);return false},stop:function(b,h){function c(){a(e.element).css("visibility","visible");b.helper&&b.helper.remove();e.helper!=e.element&&a(e.helper).remove();d.ozIndex&&a(e.helper).css("zIndex",d.ozIndex);a(e.element).prev()[0]!=b.firstSibling&&a(e.element).triggerHandler("sortupdate", [h,b.prepareCallbackObj(e,b)],d.update);a(e.element).triggerHandler("sortstop",[h,b.prepareCallbackObj(e,b)],d.stop)}var d=this.options,e=this;d.beQuietAtEnd=true;if(d.smooth){var j=a(this.element).offset();a(this.helper).animate({left:j.left-d.po.left,top:j.top-d.po.top},500,c)}else c();return false},drag:function(b,h){var c=this.options;this.pos=[this.pos[0]-(c.cursorAt.left?c.cursorAt.left:0),this.pos[1]-(c.cursorAt.top?c.cursorAt.top:0)];var d=a(this.element).triggerHandler("sort",[h,b.prepareCallbackObj(this)], c.sort),e=d&&d.left?d.left:this.pos[0];d=d&&d.top?d.top:this.pos[1];for(var j=b.set,k=0;k<j.length;k++){var i=a(j[k][0]),f=j[k][0];if(!this.element.contains(f)){var g=i.offset();g={top:g.top,left:g.left};if(c.floating){var l=(g.left-(this.pos[0]+(this.options.po?this.options.po.left:0)))/this.helper.offsetWidth;if(!(g.top<this.pos[1]+(this.options.po?this.options.po.top:0)+f.offsetHeight/2&&g.top+f.offsetHeight>this.pos[1]+(this.options.po?this.options.po.top:0)+f.offsetHeight/2))continue}else{l= (g.top-(this.pos[1]+(this.options.po?this.options.po.top:0)))/this.helper.offsetHeight;if(!(g.left<this.pos[0]+(this.options.po?this.options.po.left:0)+f.offsetWidth/2&&g.left+f.offsetWidth>this.pos[0]+(this.options.po?this.options.po.left:0)+f.offsetWidth/2))continue}if(l>=0&&l<=0.5){if(i.prev().length){i.after(this.element);c.laa=f}else{i.before(this.element);c.lba=f}break}if(l<0&&l>-0.5){if(i.next()[0]==this.element){i.before(this.element);c.lba=f}else{i.after(this.element);c.laa=f}break}}}if(a(this.element).prev()[0]!= b.lastSibling){a(this.element).triggerHandler("sortchange",[h,b.prepareCallbackObj(this,b)],this.options.change);b.lastSibling=a(this.element).prev()[0]}if(b.helper){c=a(this.element).offset();b.helper.css({top:c.top+"px",left:c.left+"px"})}a(this.helper).css("left",e+"px").css("top",d+"px");return false}})})(jQuery);